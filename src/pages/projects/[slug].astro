---
import Layout from "../../layouts/Layout.astro";
import { fade, slide } from "astro:transitions";
import Footer from "../../components/Footer.astro";
import data from "../../../data/projects.json"

export async function getStaticPaths() {
  //   const data = await fetch('../../../data/projects.json').then(response => response.json());
  return data.map((project) => {
    return {
      params: { slug: project.slug },
      props: { project },
    };
  });
}
const { project } = Astro.props;
console.log(`----------------------------------`);
console.log(project.slug.substring(0,project.slug.lastIndexOf("-")));
console.log(project.name.substring());
console.log(`----------------------------------`);
---

<Layout title={project.title}>
  <div
    class="hidden fixed top-0 left-0 w-full h-full bg-black/90 z-50 modal flex"
  >
    <span
      class="close absolute top-4 right-9 text-gray-100 text-5xl font-bold hover:text-gray-400 cursor-pointer transition-all duration-300"
      >&times;</span
    >
    <div
      class="m-auto w-full max-w-3xl transition ease-in-out overflow-hidden rounded-2xl"
    >
      <img class="modal-content w-full" />
    </div>
  </div>

  <div id="home"></div>
  <nav class="bg-primary1 w-full h-20 z-40 sticky top-0">
    <div class="bg-primary1 grid w-full px-12 h-full">
      <a
        class="ml-4 flex items-center text-offwhite text-2xl font-normal max-w-fit font-bodyfont col-start-1 max-h-ful"
        href="/"
      >
        LWJ
      </a>
      <div
        id="end_of_nav"
        class="hidden md:flex flex-row-reverse items-center col-start-2"
      >
        <div id="nav_links">
          <ul
            class="flex justify-between items-center [&>li]:pl-3 [&>*]:text-primary2"
          >
            <li>
              <a href="/#home">HOME</a>
            </li>
           <li class="projects_menu">
              <a href="#projects">PROJECTS</a>
              <div class="absolute w-fit hidden transition ease-in-out duration-1000">
                <ul
                  class="bg-white w-full text-black [&>a]:p-2 rounded-md overflow-hidden [&>a]:cursor-pointer flex flex-col [&>a]:text-left [&>a]:min-w-full "
                >
                  {
                    data.map((dataproject, index) => {
                      return data.length === index + 1 ? (
                        <a href=`/projects/${dataproject.slug}` class={project.name === dataproject.name ? `border bg-gray-300 transition ease-in-out duration-300`:`border hover:bg-gray-300 transition ease-in-out duration-300`}>
                          {dataproject.name}
                        </a>
                      ) : (
                        <a href=`/projects/${dataproject.slug}` class={project.name === dataproject.name ? `border-t border-x bg-gray-300 transition ease-in-out duration-300`:`border-t border-x hover:bg-gray-300 transition ease-in-out duration-300`}>
                          {dataproject.name}
                        </a>
                      );
                    })
                  }
                </ul>
              </div>
            </li>
            <li>
              <a href="/#about">ABOUT</a>
            </li>
            <li>
              <a href="/contact">SKILL & TECH</a>
            </li>
            <li>
              <a href="/#">CV</a>
            </li>
          </ul>
        </div>
      </div>
       <div class="flex md:hidden col-start-2 items-center place-content-end cursor-pointer burgerMenu"> 
        <svg viewBox="0 0 100 80" width="40" height="40" class="text-white">
          <rect fill="white" class="one" width="100" height="3"></rect>
          <rect fill="white" class="two"y="30" width="100" height="3"></rect>
          <rect fill="white" class="three" y="60" width="100" height="3"></rect>
        </svg>
      </div>
    </div>
    <div
      class="scrollIndicator h-0.5 self-end -ml-12 bg-white/20 col-span-2 hidden"
    >
      <div class="progress bg-accent1 h-full"></div>
    </div>
          
    </div>
     
        <div class="h-screen w-fit px-8 bg-primary1 border-l border-white absolute top-0 right-0 transition-transform translate-x-full slideMenu md:hidden">
          <span
      class="closeSlide absolute top-0 right-4 text-gray-100 text-4xl  hover:text-gray-400 cursor-pointer transition-all duration-300"
      >&times;</span>
      <div class="nav_links">
          <ul class="flex flex-col justify-between items-center [&>li]:pl-3 [&>*]:text-primary2 [&>li]:min-w-full [&>li]:p-4 mt-14 [&>li]:flex [&>li]:items-center [&>li]:justify-center">
            <li>
              <a href="#home" class="nav_link transition ease-in-out duration-200">HOME</a>
            </li>
            <li  class="projects_menu relative">
              <a href="#projects" class="nav_link transition ease-in-out duration-200">PROJECTS</a>
               <div class="absolute -left-28 w-fit hidden top-4 z-50">
                <ul
                  class="bg-white w-full text-black [&>a]:p-2 rounded-md overflow-hidden [&>a]:cursor-pointer flex flex-col [&>a]:text-left [&>a]:min-w-full  "
                >
                  {
                    data.map((dataproject, index) => {
                      return data.length === index + 1 ? (
                        <a href=`/projects/${dataproject.slug}` class={dataproject.name === project.name ? `border bg-gray-300 transition ease-in-out duration-300`:`border hover:bg-gray-300 transition ease-in-out duration-300`}>
                          {dataproject.name}
                        </a>
                      ) : (
                        <a href=`/projects/${dataproject.slug}` class={dataproject.name === project.name ? `border-t border-x bg-gray-300 transition ease-in-out duration-300`:`border-t border-x hover:bg-gray-300 transition ease-in-out duration-300`}>
                          {dataproject.name}
                        </a>
                      );
                    })
                  }
                </ul>
              </div>
            </li>
            <li>
              <a href="#about" class="nav_link transition ease-in-out duration-200">ABOUT</a>
            </li>
            <li>
              <a href="contact" class="nav_link transition ease-in-out duration-200">SKILL & TECH</a>
            </li>
            <li> 
              <a href="#" class="nav_link transition ease-in-out duration-200">CV</a>
            </li>
          </ul>
        </div>
        </div>
  </nav>
  <section
    class="grid grid-cols-12 grid-rows-[min-content_min-content_min-content] lg:grid-rows-[min-content_min-content] pl-16 lg:pl-48
    pr-10 lg:pr-32 mt-8 h-[100vh]"
  >
    <h2
      class="row-start-1 text-5xl col-span-full border-b-2 border-project_gradient mb-8"
    >
      {project.name}
    </h2>
    <div
      class="grid row-start-2 col-start-1 col-span-12 lg:col-span-5 content-center w-full mb-6"
    >
      <p>{project.description_long}</p>
    </div>
    <div
      class="row-start-3 lg:row-start-2 col-start-1 lg:col-start-7 col-span-full max-w-[630px] [&>img]:rounded-2xl overflow-hidden grid grid-cols-2 grid-rows-2 gap-4 min-w-[300px]"
    >
      {
        project.images.map((image) => (
          <>
            <img
              class="cursor-pointer w-full"
              src={`../../../assets/${image.path}`}
              alt=""
              id={image.id}
            />
          </>
        ))
      }
    </div>
  </section>
  <Footer/>
</Layout>

<script is:inline>
const close = document.querySelector(".close");
const modalContent = document.querySelector(".modal-content");
close.addEventListener("click", () => {
  close.parentElement.classList.add("hidden");
});
const allImg = document.querySelectorAll("img");
const allImgSpread = { ...allImg };
console.log(allImgSpread);
allImg.forEach((img) => {
  img.addEventListener("click", () => {
    close.parentElement.classList.remove("hidden");
    console.log();
    modalContent.setAttribute(
      "src",
      `../../../assets/${img.src.substring(img.src.lastIndexOf("/") + 1)}`
    );
  });
});


// ---------------  Dropdown menu ---------------

const projectMenus = Array.from(document.querySelectorAll(".projects_menu"))

projectMenus.map((menu) => {
  menu.addEventListener("mouseover", () => {
    menu.lastElementChild.classList.remove("hidden");
  })
})
projectMenus.map((menu) => {
  menu.addEventListener("mouseout", () => {
    menu.lastElementChild.classList.add("hidden");
  })
})

// ---------------  Burger menu ---------------
const burgerMenu = document.querySelector(".burgerMenu")
const slideMenu = document.querySelector(".slideMenu")
const menuClose = document.querySelector(".closeSlide")


burgerMenu.firstElementChild.addEventListener('click', () => {
  slideMenu.style.transform = "translateX(0%)"
})

menuClose.addEventListener('click', () => {
  slideMenu.style.transform = "translateX(100%)"
})

// --------------- Nav menu hover---------------
const navLinks = Array.from(document.querySelectorAll(".nav_link"))


for (const link of navLinks) {
  link.addEventListener('mouseover', () => {
    link.classList.add('text-gray-500');
  });

  link.addEventListener('mouseout', () => {
    link.classList.remove('text-gray-500');
  });
}


</script>

